{% extends "_base.html" %}

{% from "_macros.html" import lecture_title %}


{% block header %}
<style type="text/css">
    .card {
        margin-bottom: 1rem;
    }
    h2 {
        margin-bottom: 1.25rem;
    }
    a.btn {
        margin-right: 0.75rem;
    }
    a.btn i.fa {
        margin-right: 0.5rem;
    }
</style>
{% endblock %}


{% block breadcrumbs %}
    <li class="breadcrumb-item"><a href="{{ request.route_url('lectures_list') }}">Lectures</a></li>
    <li class="breadcrumb-item active" aria-current="page">{{ lecture_title(lecture.chambre, lecture.session, lecture.num_texte) }}</li>
{% endblock %}


{% block body %}
    <h2>{{ lecture }}</h2>

    {% if amendements %}
    <div class="card">
        <div class="card-body">
            <div class="card-title">
                <h4>Amendements</h4>
            </div>
            <div class="card-text">
                <p>{{ amendements | length }} amendements d√©pos√©s.</p>
                <p><a class="btn btn-primary" href="{{ request.route_url('list_amendements', chambre=lecture.chambre, session=lecture.session, num_texte=lecture.num_texte) }}">Consulter la liste</a></p>
            </div>
        </div>
    </div>
    {% else %}
    <div class="card">
        <div class="card-body">
            <div class="card-title">
                <h4>R√©cup√©rer les amendements</h4>
            </div>
            <div class="card-text">
            {% if lecture.chambre == 'senat' %}
                <p>R√©cup√©rer les amendements d√©pos√©s depuis le site du S√©nat.</p>
                <form method="POST" action="{{ request.route_url('fetch_amendements', chambre=lecture.chambre, session=lecture.session, num_texte=lecture.num_texte) }}">
                    <input type="submit" class="btn btn-primary" value="R√©cup√©rer">
                </form>
             {% elif lecture.chambre == 'assemblee' %}
                <p>La r√©cup√©ration des amendements depuis le site de l'Assembl√©e nationale n'est pas encore disponible. üöß</p>
            {% endif %}
            </div>
        </div>
    </div>
    {% endif %}

    {% if amendements %}
    <div class="card">
        <div class="card-body">
            <div class="card-title">
                <h4>T√©l√©charger un tableau</h4>
            </div>
                <p>T√©l√©charger un tableau de tous les amendements d√©pos√©s, tri√©s par ordre de passage.</p>
                <a class="btn btn-primary" href="{{ request.route_url('download_amendements', chambre=lecture.chambre, session=lecture.session, num_texte=lecture.num_texte, format='csv') }}"><i class="fa fa-table"></i>T√©l√©charger (CSV)</a>
                <a class="btn btn-primary" href="{{ request.route_url('download_amendements', chambre=lecture.chambre, session=lecture.session, num_texte=lecture.num_texte, format='xlsx') }}"><i class="fa fa-file-excel"></i>T√©l√©charger (Excel)</a>
            </div>
        </div>
    </div>
    {% endif %}

{% endblock %}
